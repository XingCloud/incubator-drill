{
  head : {
    type : "APACHE_DRILL_LOGICAL",
    version : 1,
    generator : {
      type : "AUTO",
      info : "sof-dsk"
    }
  },
  storage : { },
  query : [ {
    op : "unioned-scan",
    @id : 1,
    memo : "Scan(Table=sof-dsk_deu)",
    storageengine : "hbase",
    selection : [ {
      projections : [ {
        ref : "uid",
        expr : "uid"
      }, {
        ref : "value",
        expr : "value"
      } ],
      filters : null,
      rowkey : {
        end : "20130101visit.\\xFF",
        start : "20130101visit.click"
      },
      table : "sof-dsk_deu"
    }, {
      projections : [ {
        ref : "uid",
        expr : "uid"
      }, {
        ref : "value",
        expr : "value"
      } ],
      filters : null,
      rowkey : {
        end : "20130102visit.\\xFF",
        start : "20130102visit.click"
      },
      table : "sof-dsk_deu"
    } ],
    ref : "event"
  },
   {
    op: "unioned-scan-split",
    @id: 2,
    input: 1,
    entries: [0]
   },
   {
    op: "unioned-scan-split",
    @id: 3,
    input: 1,
    entries: [1]
   },
  {
    op : "collapsingaggregate",
    @id : 4,
    input : 2,
    within : null,
    target : null,
    carryovers : null,
    aggregations : [ {
      ref : "count",
      expr : "count(uid) "
    }, {
      ref : "user_num",
      expr : "count_distinct(uid) "
    }, {
      ref : "sum",
      expr : "sum(value) "
    } ]
  }, {
    op : "project",
    @id : 5,
    input : 4,
    projections : [ {
      ref : "query_id",
      expr : "'67959417-6278-46aa-ab69-460ffbd728cd'"
    }, {
      ref : "count",
      expr : "count"
    }, {
      ref : "user_num",
      expr : "user_num"
    }, {
      ref : "sum",
      expr : "sum"
    } ]
  }, 
  {
      op : "collapsingaggregate",
      @id : 6,
      input : 3,
      within : null,
      target : null,
      carryovers : null,
      aggregations : [ {
        ref : "count",
        expr : "count(uid) "
      }, {
        ref : "user_num",
        expr : "count_distinct(uid) "
      }, {
        ref : "sum",
        expr : "sum(value) "
      } ]
    }, {
      op : "project",
      @id : 7,
      input : 6,
      projections : [ {
        ref : "query_id",
        expr : "'67959417-6278-46aa-ab69-460ffbd728ce'"
      }, {
        ref : "count",
        expr : "count"
      }, {
        ref : "user_num",
        expr : "user_num"
      }, {
        ref : "sum",
        expr : "sum"
      } ]
    },
   {
        op:"union",
        @id:8,
        inputs: [5,7]
    },
  {
    op : "store",
    @id : 9,
    input : 8,
    target : null,
    partition : null,
    storageEngine : "mock"
  } ]
}