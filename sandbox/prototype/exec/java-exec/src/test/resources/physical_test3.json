{
  head: {
    type: "APACHE_DRILL_PHYSICAL",
    version: 1,
    generator: {
      type: "manual",
      info: "na"
    }
  },
  graph: [
    {
      pop: "hbase-scan",
      @id: 1,
      entries: [
        {
          table: "sof-dsk_deu",
          startRowKey: "20130101",
          endRowKey: "20130102",
          filters: [

          ],
          projections: [
            {
              ref: "uid",
              expr: "uid"
            },
            {
              ref: "event0",
              expr: "event0"
            },
            {
              ref: "val",
              expr: "value"
            }
          ]
        }
      ]
    },
    {
      pop: "mysql-scan",
      @id: 2,
      entries: [
        {
          table: "sof-dsk.language",
          projections: [
            {
              ref: "uid",
              expr: "uid"
            },
            {
              ref: "language",
              expr: "val"
            }
          ]
        }
      ]
    },
    {
      pop: "join",
      @id: 3,
      left: 2,
      right: 1,
      type: "right",
      condition: {
        relationship: "==",
        left: "uid",
        right: "uid"
      }
    },
    {
      pop: "segment",
      @id: 4,
      child: 3,
      ref: "segment",
      exprs: [
        {
          ref: "language",
          expr: "language"
        }
      ]
    },
    {
      pop: "PhysicalCollapsingAggregate",
      @id: 5,
      child: 4,
      within: "segment",
      carryovers: [
        "language"
      ],
      aggregations: [
        {
          ref: "count",
          expr: "count(uid) "
        },
        {
          ref: "user_num",
          expr: "count_distinct(uid) "
        },
        {
          ref: "sum",
          expr: "sum(val) "
        }
      ]
    },
    {
              pop: "project",
              @id: 6,
              child: 5,
              exprs: [
                {
                  ref: "count",
                  expr: "count"
                },
                {
                  ref: "user_num",
                  expr: "user_num"
                },
                {
                  ref: "sum",
                  expr: "sum"
                },
                {
                  ref: "query_id",
                  expr: "'1'"
                }

              ]
         },
    {
      pop: "screen",
      @id: 7,
      child: 6
    }
  ]
}