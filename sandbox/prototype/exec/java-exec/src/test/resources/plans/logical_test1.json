{
  head : {
    type : "APACHE_DRILL_LOGICAL",
    version : 1,
    generator : {
      type : "AUTO",
      info : "age"
    }
  },
  storage : { },
  query : [ {
    op : "unioned-scan",
    @id : 1,
    memo : "[deu_age:20130910, 20130911, deu_age:20130911, 20130911, deu_age:20130911, 20130911, deu_age:20130911, 20130912]",
    storageengine : "hbase",
    selection : [ {
      rowkey : {
        start : "20130910\\x00.\\xFF\\x00\\x00\\x00\\x00\\x00",
        end : "20130911\\x00.\\xFF\\x00\\x00\\x00\\x00\\x00"
      },
      projections : [ {
        ref : "uid",
        expr : "uid"
      }, {
        ref : "value",
        expr : "value"
      }, {
        ref : "0",
        expr : "0"
      } ],
      table : "deu_age"
    }, {
      rowkey : {
        start : "20130911\\x00.\\xFF\\x00\\x00\\x00\\x00\\x00",
        end : "20130911\\x00.\\xFF\\xFF\\xFF\\xFF\\xFF\\xFF"
      },
      projections : [ {
        ref : "uid",
        expr : "uid"
      }, {
        ref : "value",
        expr : "value"
      }, {
        ref : "0",
        expr : "0"
      } ],
      table : "deu_age"
    }, {
      rowkey : {
        start : "20130911\\x00.\\xFF\\x00\\x00\\x00\\x00\\x00",
        end : "20130911\\x00.\\xFF\\xFF\\xFF\\xFF\\xFF\\xFF"
      },
      projections : [ {
        ref : "uid",
        expr : "uid"
      }, {
        ref : "value",
        expr : "value"
      }, {
        ref : "0",
        expr : "0"
      } ],
      table : "deu_age"
    }, {
      rowkey : {
        start : "20130911\\x00.\\xFF\\xFF\\xFF\\xFF\\xFF\\xFF",
        end : "20130912\\x00.\\xFF\\xFF\\xFF\\xFF\\xFF\\xFF"
      },
      projections : [ {
        ref : "uid",
        expr : "uid"
      }, {
        ref : "value",
        expr : "value"
      }, {
        ref : "0",
        expr : "0"
      } ],
      table : "deu_age"
    } ],
    ref : "event"
  }, {
    op : "unioned-scan-split",
    @id : 2,
    memo : "[0]",
    input : 1,
    entries : [ 0 ]
  }, {
    op : "unioned-scan-split",
    @id : 3,
    memo : "[2]",
    input : 1,
    entries : [ 2 ]
  }, {
    op : "union",
    @id : 4,
    inputs : [ 2, 3 ],
    distinct : false
  }, {
    op : "unioned-scan-split",
    @id : 5,
    memo : "[1]",
    input : 1,
    entries : [ 1 ]
  }, {
    op : "unioned-scan-split",
    @id : 6,
    memo : "[3]",
    input : 1,
    entries : [ 3 ]
  }, {
    op : "union",
    @id : 7,
    inputs : [ 5, 6 ],
    distinct : false
  }, {
    op : "union",
    @id : 8,
    inputs : [ 4, 7 ],
    distinct : false
  }, {
    op : "segment",
    @id : 9,
    input : 8,
    exprs : [ {
      ref : "dimension",
      expr : "0"
    } ],
    name : "sgmt"
  }, {
    op : "collapsingaggregate",
    @id : 10,
    input : 9,
    within : "sgmt",
    target : null,
    carryovers : [ "dimension" ],
    aggregations : [ {
      ref : "count",
      expr : "count(uid) "
    }, {
      ref : "user_num",
      expr : "count_distinct(uid) "
    }, {
      ref : "sum",
      expr : "sum(value) "
    } ]
  }, {
    op : "project",
    @id : 11,
    input : 10,
    projections : [ {
      ref : "query_id",
      expr : "'GROUP,age,2013-09-10,2013-09-11,*.*,TOTAL_USER,VF-ALL-0-0,EVENT,0'"
    }, {
      ref : "dimension",
      expr : "dimension"
    }, {
      ref : "count",
      expr : "count"
    }, {
      ref : "user_num",
      expr : "user_num"
    }, {
      ref : "sum",
      expr : "sum"
    } ]
  }, {
    op : "store",
    @id : 12,
    input : 11,
    target : null,
    partition : null,
    storageEngine : "DEFAULT-STORE"
  } ]
}
