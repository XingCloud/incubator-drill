{
  head : {
    type : "APACHE_DRILL_LOGICAL",
    version : 1,
    generator : {
      type : "AUTO",
      info : "testtable_100w"
    }
  },
  storage : { },
  query : [ {
    op : "scan",
    @id : 1,
    memo : "Scan(Table=testtable_100w_deu)",
    storageengine : "hbase",
    selection : [ {
      projections : [ {
        ref : "uid",
        expr : "uid"
      }, {
        ref : "value",
        expr : "value"
      } ],
      filters : null,
      rowkey : {
        end : "MjAxMzA3MDF2aXNpdA==",
        start : "MjAxMzA3MDF2aXNpdA=="
      },
      table : "testtable_100w_deu"
    } ],
    ref : "testtable_100w_deu"
  }, {
    op : "scan",
    @id : 2,
    memo : "Scan(Table=property_testtable_100w_index, Prop=ref, Val=google)",
    storageengine : "hbase",
    selection : [ {
      projections : [ {
        ref : "uid",
        expr : "uid"
      } ],
      filters : null,
      rowkey : {
        end : "AAkyMDEzMDgwNQ==",
        start : "AAkyMDEzMDgwNQ=="
      },
      table : "property_testtable_100w_index"
    } ],
    ref : "property_testtable_100w_index"
  }, {
    op : "scan",
    @id : 3,
    memo : "Scan(Table=property_testtable_100w_index, Prop=register_time, Val=2013-07-12)",
    storageengine : "hbase",
    selection : [ {
      projections : [ {
        ref : "uid",
        expr : "uid"
      } ],
      filters : null,
      rowkey : {
        end : "AA8yMDEzMDgwNQ==",
        start : "AA8yMDEzMDgwNQ=="
      },
      table : "property_testtable_100w_index"
    } ],
    ref : "property_testtable_100w_index"
  }, {
    op : "join",
    @id : 4,
    left : 2,
    right : 3,
    conditions : [ {
      relationship : "==",
      left : "property_testtable_100w_index.uid",
      right : "property_testtable_100w_index.uid"
    } ],
    type : "INNER"
  }, {
    op : "scan",
    @id : 5,
    memo : "Scan(Table=property_testtable_100w_index, Prop=language, Val=zh_cn)",
    storageengine : "hbase",
    selection : [ {
      projections : [ {
        ref : "uid",
        expr : "uid"
      } ],
      filters : null,
      rowkey : {
        end : "AAMyMDEzMDgwNQ==",
        start : "AAMyMDEzMDgwNQ=="
      },
      table : "property_testtable_100w_index"
    } ],
    ref : "property_testtable_100w_index"
  }, {
    op : "join",
    @id : 6,
    left : 4,
    right : 5,
    conditions : [ {
      relationship : "==",
      left : "property_testtable_100w_index.uid",
      right : "property_testtable_100w_index.uid"
    } ],
    type : "INNER"
  }, {
    op : "join",
    @id : 7,
    left : 1,
    right : 6,
    conditions : [ {
      relationship : "==",
      left : "testtable_100w_deu.uid",
      right : "property_testtable_100w_index.uid"
    } ],
    type : "INNER"
  }, {
    op : "collapsingaggregate",
    @id : 8,
    input : 7,
    within : null,
    target : null,
    carryovers : null,
    aggregations : [ {
      ref : "event_count",
      expr : "count('testtable_100w_deu.uid') "
    }, {
      ref : "user_number",
      expr : "count_distinct('testtable_100w_deu.uid') "
    }, {
      ref : "event_sum",
      expr : "sum('testtable_100w_deu.value') "
    } ]
  }, {
    op : "store",
    @id : 9,
    input : 8,
    target : {
      file : "console:///stdout"
    },
    partition : null,
    storageEngine : "console"
  } ]
}